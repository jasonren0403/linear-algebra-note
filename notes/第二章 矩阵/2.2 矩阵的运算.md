# $\S 2.2$ 矩阵的运算

同型矩阵：两个矩阵行数和列数分别相等，则称它们为**同型矩阵**。

## 矩阵相等

两个同型矩阵，对应位置元素都相等，则称两个矩阵相等。

### 例

$A=\begin{bmatrix}2 & 3 & 1 \\ 1 & 2 & -1\\0& 3 & 1\end{bmatrix}$，$B=\begin{bmatrix}2 & 3 & x+y \\1&y+z&-1\\2+x&3&1\end{bmatrix}$，$A=B$，求 $x、y、z$

解：

$$
\begin{align*}
\begin{cases}
x+y=1\\
y+z=2\\
2+x=0
\end{cases}\Rightarrow
\begin{cases}
x=-2\\
y=3\\
z=-1
\end{cases}
\end{align*}
$$

## 加法

$A=(a_{ij})_{m\times n}$，$B=(b_{ij})_{m\times n}$，$C=A+B=(a_{ij}+b_{ij})_{m\times n}$

**注**：注意与行列式加法的区别

* 矩阵加具有加法结合律和交换律
* 零元：$0+A=A+0=A$

## 数乘

$cA=(c \cdot a_{ij})_{m\times n},A\in M_n(\mathbb R)$

**注**：注意与行列式数乘的区别（$|kA|=k^n|A|$）

* 矩阵数乘具有乘法结合律
    * $k(lA)=(kl)A$，A为矩阵，k、l为数
* 乘法零元和幺元：$1\cdot A=A$，$0\cdot A = 0$
* 矩阵数乘具有乘法分配律，以下A、B为矩阵，k、l为数
    * $k(A+B)=kA+kB$
    * $(k+l)A=kA+lA$

## 减法

$A-B=A+(-B)$，此时称 $(-1)\cdot B$ 为矩阵 $B$ 的负矩阵，记为 $-B$，且 $B+(-B)=0$（负元）

## 转置

$$
\begin{align*}
A=(a_{ij})_{m\times n}=\begin{bmatrix}
a_{11} & a_{12} & \cdots & a_{1n}\\
a_{21} & a_{22} & \cdots & a_{2n}\\
\vdots & \vdots & & \vdots\\
a_{m1} & a_{m2} & \cdots & a_{mn}
\end{bmatrix}
\end{align*}
$$

称 $A^T(A')=\begin{bmatrix}
a_{11} & a_{21} & \cdots & a_{m1}\\
a_{12} & a_{22} & \cdots & a_{m2}\\
\vdots & \vdots & & \vdots\\
a_{1n} & a_{2n} & \cdots & a_{mn}
\end{bmatrix}_{n\times m}$ 为A的转置（Transpose）矩阵

### 性质

* $(A^T)^T=A$
* $(kA)^T=k(A^T)$
* $(A+B)^T=A^T+B^T$

### 注意点

* 若 $A\in M_n(\mathbb R)$，且 $A^T=A$（$a_{ij}=a_{ji}$），则称 $A$ 为对称矩阵
    * 例 $\begin{bmatrix}1 & 4 & 5\\4 & 2 & 6\\5 & 6 & 3\end{bmatrix}$
* 若 $A\in M_n(\mathbb R)$，且 $A^T=-A$（$a_{ij}=-a_{ji}$），则称 $A$ 为反对称矩阵
    * 此时对角元为零
    * 例 $\begin{bmatrix}0 & 1 & 2\\-1 & 0 & 3\\2 & -3 & 0\end{bmatrix}$

### 例题

1. 证明：对称矩阵的和仍为对称矩阵

    证：$A^T=A$，$B^T=B$，$(A+B)^T=A^T+B^T=A+B$

    > 同理：反对称矩阵的和仍为反对称矩阵

2. 证明：任何一个方阵均可写作一个对称矩阵与一个反对称矩阵的和

    证：$A=\dfrac{A+A^T}{2}+\dfrac{A-A^T}{2}$

    令 $B=\dfrac{A+A^T}{2}$，$C=\dfrac{A-A^T}{2}$

    * $B^T=\dfrac{1}{2}(A^T+A)=B$ 为对称矩阵
    * $C^T=\dfrac{1}{2}(A^T-A)=-C$ 为反对称矩阵

## 乘法

### 来源

已知 $B=(b_{ij})_{m\times n}$，$A=(a_{ij})_{t\times m}$，$l_1\cdots l_m$

$$
\begin{align*}
&\begin{cases}
b_{11}x_1+b_{12}x_2+\cdots+b_{1n}x_n=y_1\\
b_{12}x_1+b_{22}x_2+\cdots+b_{2n}x_n=y_2\\
\vdots\\
b_{m1}x_1+b_{m2}x_2+\cdots+b_{mn}x_n=y_n
\end{cases}\\
&\begin{cases}
a_{11}y_1+a_{12}y_2+\cdots+a_{1m}y_m=l_1\\
a_{21}y_1+a_{22}y_2+\cdots+a_{2m}y_m=l_2\\
\vdots\\
a_{t1}y_1+a_{t2}y_2+\cdots+a_{tm}y_m=l_m
\end{cases}
\end{align*}
$$

欲通过 $y_1,y_2,\cdots,y_m$ 求 $x_1,x_2,\cdots,x_n$，要得到第 $i$ 个方程 $x_j$ 的系数，用矩阵 $A$ 第 $i$ 行，乘以矩阵 $B$ 的第 $j$ 列对应相加。

### 定义

矩阵乘法 $A_{t\times m}\cdot B_{m\times n}=C_{t\times n}$，其中 $C_{ij}=a_{i1}b_{1j}+a_{i2}b_{2j}+\cdots+a_{im}b_{mj}$

若 $AB=BA$，则称 A、B 可交换

### 例题

1. $A=\begin{bmatrix}2 & 3 & 1\\1 & 2 & -1\\0 & 3 & 1\end{bmatrix}_{3\times 3}$，$B=\begin{bmatrix}0\\1\\2\end{bmatrix}_{3\times 1}$

    解：

    $$
    \begin{align*}
    AB=\begin{bmatrix}
    2\times 0 + 3\times 1 + 1\times 2\\
    1\times 0 + 2\times 1 + (-1)\times 2\\
    0\times 0 + 3\times 1 + 1\times 2\\
    \end{bmatrix}=\begin{bmatrix}
    5\\0\\5
    \end{bmatrix}
    \end{align*}
    $$

2. $A=\begin{bmatrix}a_1\\a_2\end{bmatrix}_{2\times 1}$，$B=\begin{bmatrix}b_1&b_2\end{bmatrix}_{1\times 2}$

    解：

    $$
    \begin{align*}
    AB=\begin{bmatrix}
    a_1b_1 & a_1b_2\\
    a_2b_1 & a_2b_2
    \end{bmatrix}
    \end{align*}
    $$

    $$
    \begin{align*}
    BA=a_1b_1+a_2b_2
    \end{align*}
    $$

3. $A=\begin{bmatrix}1 & 1\\-1 & -1\end{bmatrix}$，$B=\begin{bmatrix}1 & -1\\-1 & 1\end{bmatrix}$

    解：

    $$
    \begin{align*}
    AB=\begin{bmatrix}
    1\times 1+1\times (-1) & 1\times (-1)+(-1)\times 1\\
    (-1)\times 1+(-1)\times (-1) & (-1)\times (-1)+(-1)\times 1
    \end{bmatrix}=\begin{bmatrix}
    0 & 0\\
    0 & 0\end{bmatrix}
    \end{align*}
    $$

    $$
    \begin{align*}
    BA=\begin{bmatrix}
    2 & 2\\
    -2 & -2
    \end{bmatrix}\ne AB
    \end{align*}
    $$

4. $A=\begin{bmatrix}1 & 2\\2 & 4\end{bmatrix}$，$B=\begin{bmatrix}-1 & 3\\-2 & 1\end{bmatrix}$，$C=\begin{bmatrix}-7 & 1\\1 & 2\end{bmatrix}$

    解：

    $$
    \begin{align*}
    AB=\begin{bmatrix}
    -5 & 5\\
    -10 & 10\end{bmatrix}
    \end{align*}
    $$

    $$
    \begin{align*}
    AC=\begin{bmatrix}
    -5 & 5\\
    -10 & 10\end{bmatrix}
    \end{align*}
    $$

## 性质

* $O\times A=O$，$A\times O=O$
* $I\cdot A=A$，$A\cdot I=A$
* $A(B+C)=AB+AC$，$(B+C)A=BA+CA$
* $A(BC)=(AB)C$
    * 证明：设 $A_{m\times n}$，$B_{n\times s}$，$C_{s\times t}$
* $(AB)^T=B^TA^T$
    * 证明：设 $A_{m\times n}$，$B_{n\times s}$，则 $B^T_{s\times n}$，$A^T_{n\times m}$

        $(AB)^T$ 第 $i$ 行第 $j$ 列的元素为 $AB$ 的第 $j$ 行第 $i$ 列，即 $\sum_{k=1}^na_{jk}b_{ki}$

        $B^TA^T$ 的第 $i$ 行第 $j$ 列的元素为 $\sum_{k=1}^n b'_{ik}a'_{kj}=\sum_{k=1}^n b_{ki}a_{jk}$

        从而 $(AB)^T=B^TA^T$
* 初等行变换相当于矩阵左乘，初等列变换相当于矩阵右乘

    $$
    \begin{align*}
    \begin{bmatrix}
    \lambda_1\\
    & \lambda_2 \\
    & & \ddots \\
    & & & \lambda_m \\
    \end{bmatrix}
    \begin{bmatrix}
    a_{11} & a_{12} & \cdots & a_{1n}\\
    a_{21} & a_{22} & \cdots & a_{2n}\\
    \vdots & \vdots & & \vdots \\
    a_{m1} & a_{m2} & \cdots & a_{mn}\\
    \end{bmatrix}=
    \begin{bmatrix}
    \lambda_1a_{11} & \lambda_1a_{12} & \cdots & \lambda_1a_{1n}\\
    \lambda_2a_{21} & \lambda_2a_{22} & \cdots & \lambda_2a_{2n}\\
    \vdots & \vdots & & \vdots \\
    \lambda_ma_{m1} & \lambda_ma_{m2} & \cdots & \lambda_ma_{mn}\\
    \end{bmatrix} \\

    \begin{bmatrix}
    a_{11} & a_{12} & \cdots & a_{1n}\\
    a_{21} & a_{22} & \cdots & a_{2n}\\
    \vdots & \vdots & & \vdots \\
    a_{m1} & a_{m2} & \cdots & a_{mn}\\
    \end{bmatrix}
    \begin{bmatrix}
    \mu_1\\
    & \mu_2 \\
    & & \ddots \\
    & & & \mu_n \\
    \end{bmatrix}=
    \begin{bmatrix}
    \mu_1a_{11} & \mu_2a_{12} & \cdots & \mu_na_{1n}\\
    \mu_1a_{21} & \mu_2a_{22} & \cdots & \mu_na_{2n}\\
    \vdots & \vdots & & \vdots \\
    \mu_1a_{m1} & \mu_2a_{m2} & \cdots & \mu_na_{mn}\\
    \end{bmatrix}
    \end{align*}
    $$

### 注
* $AB=O\not \Rightarrow A=O$ 或 $B=O$
* $AB=AC\not \Rightarrow B=C$

## 矩（方）阵乘方

$A^n=\underbrace{A\cdot A\cdot \cdots A}_{n个}$

借用 $f(x)$ 记号，设 $f(x)$ 为多项式 $a_nx^n+a_{n-1}x^{n-1}+\cdots +a_1x+a_0(a_n\ne 0)$，记 $f(A)=a_nA^n+a_{n-1}A^{n-1}+\cdots+a_1A+a_0I$，称 $f(A)$ 为矩阵的多项式

### 注
* $A^k\cdot A^l=A^{k+l}$，$(A^k)^l=A^{kl}$，$k,l\in N^*$
* 一般地，$A,B\in M_n(k)$，$AB\ne BA$
    * $(AB)^k=(AB)(AB)\cdots(AB)\ne A^kB^k$
    * 当 $AB=BA$ 时，$(AB)^k=A^kB^k$
* 一般地，$f(A)$ 是 A 的矩阵多项式，$g(B)$ 是 B 的矩阵多项式，$f(A)g(B)\ne g(B)f(A)$
    * $AB=BA$ 时，$f(A)g(B)=g(B)f(A)$；特别地，$f(A)g(A)=g(A)f(A)$
    * $(A+B)(A-B)\ne (A-B)(A+B)$，但 $(A+I)(A-I)=(A-I)(A+I)$
* 方阵的行列式
    * $|A+B|\ne |A|+|B|$
    * $|kA|=k^n|A|$，特别地，$\big||A|B\big|=|A|^n|B|$
## 例题

1. $A=\begin{bmatrix}2 & 0 & -1 \\ 1 & 3 & 2\end{bmatrix}$，$B=\begin{bmatrix}1 & 7 & -1\\4 & 2 & 3\\2 & 0 & 1\end{bmatrix}$

    * $(AB)^T=B^T\cdot A^T=\begin{bmatrix}1 & 4 & 2\\7 & 2 & 0\\-1 & 3 & 1\end{bmatrix}\cdot \begin{bmatrix}2 & 1\\0 & 3\\-1 & 2\end{bmatrix}=\begin{bmatrix}0 & 17\\14 & 13\\-3 & 10\end{bmatrix}$
    * 注：（反）对称矩阵的乘积不一定是（反）对称矩阵

2. 证明：A、B均为n阶对称矩阵，若 $AB=BA$，则 $AB$ 为对称阵

    * 证：$(AB)^T=B^TA^T=BA=AB$，即 $AB$ 为对称阵
    * 注：上（下）三角阵的乘积仍是上（下）三角阵

3. $\alpha=(\dfrac{1}{2},\dfrac{1}{2},\dfrac{1}{2},\dfrac{1}{2})^T$，$A=E-\alpha\alpha^T$，$B=E+2\alpha\alpha^T$，求 $AB$

    解：

    $$
    \begin{align*}
    AB&=(E-\alpha\alpha^T)(E+2\alpha\alpha^T)\\
    &=E^{2}+2\alpha\alpha^T-\alpha\alpha^T-2\alpha\alpha^T\alpha\alpha^T\\
    &=E+\alpha\alpha^T-2\alpha(\alpha^T\alpha)\alpha^T\\
    &=E+\alpha\alpha^T-2\alpha\alpha^T\\
    &=E-\alpha\alpha^T\\
    &=\begin{bmatrix}
    \dfrac{3}{4} & -\dfrac{1}{4} & -\dfrac{1}{4} & -\dfrac{1}{4}\\
    -\dfrac{1}{4} & \dfrac{3}{4} & -\dfrac{1}{4} & -\dfrac{1}{4}\\
    -\dfrac{1}{4} & -\dfrac{1}{4} & \dfrac{3}{4} & -\dfrac{1}{4}\\
    -\dfrac{1}{4} & -\dfrac{1}{4} & -\dfrac{1}{4} & \dfrac{3}{4}\\
    \end{bmatrix}
    \end{align*}
    $$

4. $\alpha=\begin{bmatrix}1\\2\\3\end{bmatrix}$，$\beta=\begin{bmatrix}1\\\frac{1}{2}\\0\end{bmatrix}$，$A=\alpha\beta^T$，求 $A^4$

    解：

    $$
    \begin{align*}
    A^4&=(\alpha\color{red}{\beta^T})(\color{red}{\alpha}\color{green}{\beta^T})(\color{green}{\alpha}\color{blue}{\beta^T})(\color{blue}{\alpha}\beta^T)\\
    &=2\times 2\times 2\alpha\beta^T\\
    &=8\begin{bmatrix}1\\2\\3\end{bmatrix}\begin{bmatrix}1&\frac{1}{2}&0\end{bmatrix}\\
    &=\begin{bmatrix}
    8 & 4 & 0\\
    16 & 8 & 0\\
    24 & 12 & 0
    \end{bmatrix}
    \end{align*}
    $$

5. $A=\begin{bmatrix}2 & 4 & 6\\1 & 2 & 3\\1 & 2 & 3\end{bmatrix}$，求 $A^n(n\in N^*)$

    解：

    $$
    \begin{align*}
    A=\begin{bmatrix}
    2\\1\\1
    \end{bmatrix}
    \begin{bmatrix}
    1 & 2 & 3
    \end{bmatrix}
    \end{align*}
    $$

    $$
    \begin{align*}
    A^n&=\underbrace{A\cdot A\cdot \cdots A}_{n个}\\
    &=\begin{bmatrix}
    2\\1\\1
    \end{bmatrix}
    \color{red}{\begin{bmatrix}
        1 & 2 & 3
        \end{bmatrix}\begin{bmatrix}
        2\\1\\1
        \end{bmatrix}
    }
    \color{green}{\begin{bmatrix}
        1 & 2 & 3
        \end{bmatrix}
    }
    \cdots
    \begin{bmatrix}
    2\\1\\1
    \end{bmatrix}
    \begin{bmatrix}
    1 & 2 & 3
    \end{bmatrix}\\
    &=7^{n-1}\begin{bmatrix}
    2\\1\\1
    \end{bmatrix}
    \begin{bmatrix}
    1 & 2 & 3
    \end{bmatrix}\\
    &=7^{n-1}A
    \end{align*}
    $$

6. $\beta$ 是一个 $3\times 1$ 的矩阵，$\beta \cdot \beta^T=\begin{bmatrix}1 & -1 & -2\\-1 & 1 & 2\\-2 & 2 & 4\end{bmatrix}$，求 $\beta^T \cdot \beta$

    解：设 $\beta=\begin{bmatrix}a\\b\\c\end{bmatrix}$，则 $\beta^T=\begin{bmatrix}a&b&c\end{bmatrix}$

    $$
    \begin{align*}
    \beta \cdot \beta^T = \begin{bmatrix}
    a^2 & ab & ac\\
    ba & b^2 & bc\\
    ca & cb & c^2
    \end{bmatrix}
    \end{align*}
    $$

    $\beta^T \beta=a^2+b^2+c^2=6$

7. 已知式子 $\begin{bmatrix}x_1&x_2&x_3\end{bmatrix}\begin{bmatrix}1&0&-2\\2&4&-1\\0&-3&5\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}$，求 $x_2x_3$ 的系数

    解：原式 $=\begin{bmatrix}x_1+2x_2 & 4x_2\color{red}{-3x_3} & -2x_1\color{blue}{-x_2}+5x_3\end{bmatrix}\begin{bmatrix}x_1\\\color{red}{x_2}\\\color{blue}{x_3}\end{bmatrix}$

    $-3-1=-4$

8. $A=\begin{bmatrix}\alpha & \alpha_1 & \alpha_2 & \alpha_3\end{bmatrix}$，$B=\begin{bmatrix}\beta & \alpha_1 & \alpha_2 & \alpha_3\end{bmatrix}$，其中 $\alpha$、$\alpha_1$、$\alpha_2$、$\alpha_3$、$\beta$ 为 4 维列向量，$|A|=-1$，$|B|=-5$，求 $|A+B|$

    解：$A+B=\begin{bmatrix}\beta+\alpha & 2\alpha_1 & 2\alpha_2 & 2\alpha_3\end{bmatrix}$

    $$
    \begin{align*}
    |A+B|&=|\beta+\alpha \quad 2\alpha_1 \quad 2\alpha_2 \quad 2\alpha_3 |\\
    &=8|\beta+\alpha \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|\\
    &=8(|\beta \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|+|\alpha \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|)\\
    &=8(|B|+|A|)\\
    &=-48
    \end{align*}
    $$

9. $\alpha_1$、$\alpha_2$、$\alpha_3$、$\beta$、$\gamma$ 是 4 维列向量，若 $\begin{vmatrix}\alpha_1 & \alpha_2 & \alpha_3 & \gamma\end{vmatrix}=a$，$\begin{vmatrix}\beta+\gamma & \alpha_1 & \alpha_2 & \alpha_3\end{vmatrix}=b$，求 $\begin{vmatrix}2\beta & \alpha_1 & \alpha_2 & \alpha_3\end{vmatrix}$

    解：

    $$
    \begin{align*}
    |2\beta \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|&=2|\beta \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|\\
    &=2(|\beta+\gamma \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|+|-\gamma \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|)\\
    &=2(|\beta+\gamma \quad \alpha_1 \quad \alpha_2 \quad \alpha_3|+|\alpha_1 \quad \alpha_2 \quad \alpha_3 \quad \gamma|)\\
    &=2(b+a)\\
    &=2a+2b
    \end{align*}
    $$
